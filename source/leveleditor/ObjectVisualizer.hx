package leveleditor;

import flixel.math.FlxPoint;
import flixel.group.FlxGroup.FlxTypedGroup;
import flixel.FlxBasic;

class ObjectVisualizer extends GenericObjectVisualizer {

    public var components:FlxTypedGroup<ComponentVisualizer>;

    override public function new() {
        super();

        components = new FlxTypedGroup();
    }

    override function destroy() {

        components.destroy();
        components = null;

        super.destroy();
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    
    override function update(elapsed:Float) {
        transform.update(elapsed);
        components.update(elapsed);
        children.update(elapsed);
    }

    override function drawObject() {
        components.draw();
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    override public function onActiveLayerChange(to:Bool) {
        for (component in components) {
            component.onActiveLayerChange(to);
        }

        super.onActiveLayerChange(to);
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    override public function checkIsHit(mousePos:FlxPoint):ObjectVisualizer {
        for (component in components) {
            if(component.checkCollides(mousePos)) return this;
        }
        
        return super.checkIsHit(mousePos);
    }

}